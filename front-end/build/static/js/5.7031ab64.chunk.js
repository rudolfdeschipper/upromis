(this.webpackJsonpupromisfrontend=this.webpackJsonpupromisfrontend||[]).push([[5],{118:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(21),r=a(22),i=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"formatDate",value:function(e){if(null==e||"undefined"===e)return"";var t=new Date(e);return t.getDate().toString()+"/"+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]+"/"+t.getFullYear().toString()}},{key:"formatDateForEdit",value:function(e){var t=new Date(e);return t.getFullYear().toString()+"/"+(t.getMonth()+1).toString()+"/"+t.getDate().toString()}},{key:"formatAmount",value:function(e){for(var t=e.toFixed(2),a=0|t,n=e<0?1:0,r=(""+Math.abs(t-a).toFixed(2)).substr(2,2),i=""+a,o=i.length,c="";(o-=3)>n;)c=","+i.substr(o,3)+c;return"\u20ac "+i.substr(0,o+3)+c+(r?"."+r:"")}},{key:"dateSorter",value:function(e,t,a){e=null===e||void 0===e?-1/0:e,t=null===t||void 0===t?-1/0:t;var n=new Date(e),r=new Date(t);return n>r?a?-1:1:n<r?a?1:-1:0}}]),e}()},167:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(21),r=a(118),i=function e(){Object(n.a)(this,e)};i.loadList=function(e){return fetch("http://localhost:5001/api/home/getcontractdata",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify({page:e.page,pageSize:e.pageSize,sorted:e.sorted,filtered:e.filtered})}).then((function(e){return e.json()}))},i.loadListForExport=function(e,t){return fetch("http://localhost:5001/api/home/getcontractdataexport",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({page:1,pageSize:t.pageSize,sorted:t.sorted,filtered:t.filtered})}).then((function(t){t.blob().then((function(t){var a=window.URL.createObjectURL(t),n=document.createElement("a"),i=e+" - "+r.a.formatDate(Date.now()).replace(/\//g,"-")+".xlsx";n.href=a,n.download=i,n.click(),n.remove()}))})).catch((function(e){return console.error(e)}))},i.saveRecord=function(e){return fetch("http://localhost:5001/api/home/postonecontractdata",{method:e.action,headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify({id:e.id,dataSubject:e.dataSubject,action:e.action,subaction:e.subaction,additionalData:e.additionalData})}).then((function(e){return e.json()}))},i.loadOneRecord=function(e){return fetch("http://localhost:5001/api/home/getonecontractdata",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({ID:e})}).then((function(e){return e.json()}))},i.loadDropdownValues=function(e){return fetch("http://localhost:5001/api/home/getselectvalues",{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({valueType:e})}).then((function(e){return e.json()}))}},432:function(e,t,a){"use strict";a.r(t);var n,r=a(169),i=a(21),o=a(22),c=a(23),l=a(24),s=a(1),d=a.n(s),u=(a(171),a(63)),m=a(13),p=a(29),f=a(60),b=a(11),v=function(e){var t=Object(p.a)(e,{activeKey:"onSelect"}),a=t.id,n=t.generateChildId,r=t.onSelect,i=t.activeKey,o=t.transition,c=t.mountOnEnter,l=t.unmountOnExit,u=t.children,m=Object(s.useMemo)((function(){return n||function(e,t){return a?a+"-"+t+"-"+e:null}}),[a,n]),v=Object(s.useMemo)((function(){return{onSelect:r,activeKey:i,transition:o,mountOnEnter:c,unmountOnExit:l,getControlledId:function(e){return m(e,"tabpane")},getControllerId:function(e){return m(e,"tab")}}}),[r,i,o,c,l,m]);return d.a.createElement(f.a.Provider,{value:v},d.a.createElement(b.a.Provider,{value:r},u))},E=a(3),h=a(5),O=a(2),y=a.n(O),g=a(6),w=d.a.forwardRef((function(e,t){var a=e.bsPrefix,n=e.as,r=void 0===n?"div":n,i=e.className,o=Object(h.a)(e,["bsPrefix","as","className"]),c=Object(g.a)(a,"tab-content");return d.a.createElement(r,Object(E.a)({ref:t},o,{className:y()(i,c)}))})),D=a(66),j=a(37),S=a(67),x=((n={})[j.b]="show",n[j.a]="show",n),N=d.a.forwardRef((function(e,t){var a=e.className,n=e.children,r=Object(h.a)(e,["className","children"]),i=Object(s.useCallback)((function(e){Object(S.a)(e),r.onEnter&&r.onEnter(e)}),[r]);return d.a.createElement(j.e,Object(E.a)({ref:t,addEndListener:D.a},r,{onEnter:i}),(function(e,t){return d.a.cloneElement(n,Object(E.a)({},t,{className:y()("fade",a,n.props.className,x[e])}))}))}));N.defaultProps={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},N.displayName="Fade";var P=N;var I=d.a.forwardRef((function(e,t){var a=function(e){var t=Object(s.useContext)(f.a);if(!t)return e;var a=t.activeKey,n=t.getControlledId,r=t.getControllerId,i=Object(h.a)(t,["activeKey","getControlledId","getControllerId"]),o=!1!==e.transition&&!1!==i.transition,c=Object(b.b)(e.eventKey);return Object(E.a)({},e,{active:null==e.active&&null!=c?Object(b.b)(a)===c:e.active,id:n(e.eventKey),"aria-labelledby":r(e.eventKey),transition:o&&(e.transition||i.transition||P),mountOnEnter:null!=e.mountOnEnter?e.mountOnEnter:i.mountOnEnter,unmountOnExit:null!=e.unmountOnExit?e.unmountOnExit:i.unmountOnExit})}(e),n=a.bsPrefix,r=a.className,i=a.active,o=a.onEnter,c=a.onEntering,l=a.onEntered,u=a.onExit,m=a.onExiting,p=a.onExited,v=a.mountOnEnter,O=a.unmountOnExit,w=a.transition,D=a.as,j=void 0===D?"div":D,S=(a.eventKey,Object(h.a)(a,["bsPrefix","className","active","onEnter","onEntering","onEntered","onExit","onExiting","onExited","mountOnEnter","unmountOnExit","transition","as","eventKey"])),x=Object(g.a)(n,"tab-pane");if(!i&&!w&&O)return null;var N=d.a.createElement(j,Object(E.a)({},S,{ref:t,role:"tabpanel","aria-hidden":!i,className:y()(r,x,{active:i})}));return w&&(N=d.a.createElement(w,{in:i,onEnter:o,onEntering:c,onEntered:l,onExit:u,onExiting:m,onExited:p,mountOnEnter:v,unmountOnExit:O},N)),d.a.createElement(f.a.Provider,{value:null},d.a.createElement(b.a.Provider,{value:null},N))}));I.displayName="TabPane";var R=I,C=function(e){function t(){return e.apply(this,arguments)||this}return Object(m.a)(t,e),t.prototype.render=function(){throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")},t}(d.a.Component);C.Container=v,C.Content=w,C.Pane=R;var A=C,T=(a(76),a(27)),M=a(45),k=a(44);function q(e,t){var a=0;return d.a.Children.map(e,(function(e){return d.a.isValidElement(e)?t(e,a++):e}))}function K(e){var t;return function(e,t){var a=0;d.a.Children.forEach(e,(function(e){d.a.isValidElement(e)&&t(e,a++)}))}(e,(function(e){null==t&&(t=e.props.eventKey)})),t}function L(e){var t=e.props,a=t.title,n=t.eventKey,r=t.disabled,i=t.tabClassName;return null==a?null:d.a.createElement(k.a,{as:M.a,eventKey:n,disabled:r,className:i},a)}var F=d.a.forwardRef((function(e,t){var a=Object(p.a)(e,{activeKey:"onSelect"}),n=a.id,r=a.onSelect,i=a.transition,o=a.mountOnEnter,c=a.unmountOnExit,l=a.children,s=a.activeKey,u=void 0===s?K(l):s,m=Object(h.a)(a,["id","onSelect","transition","mountOnEnter","unmountOnExit","children","activeKey"]);return d.a.createElement(v,{ref:t,id:n,activeKey:u,onSelect:r,transition:i,mountOnEnter:o,unmountOnExit:c},d.a.createElement(T.a,Object(E.a)({},m,{role:"tablist",as:"nav"}),q(l,L)),d.a.createElement(w,null,q(l,(function(e){var t=Object(E.a)({},e.props);return delete t.title,delete t.disabled,delete t.tabClassName,d.a.createElement(R,t)}))))}));F.defaultProps={variant:"tabs",mountOnEnter:!1,unmountOnExit:!1},F.displayName="Tabs";var J=F,V=a(136),U=a(139),z=a(168),H=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={isSubmitting:!1},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return d.a.createElement(V.b,{initialValues:this.props.currentData,enableReinitialize:!0,validationSchema:U.object({code:U.string().max(15,"Must be 15 characters or less").required("Required"),title:U.string().max(100,"Must be 100 characters or less").required("Required"),description:U.string().required("Required"),startdate:U.date().required("Required"),enddate:U.date().required("Required"),status:U.string().required("Required").oneOf(["Planned","Open","Closed"]),value:U.number().required("Required")}),onSubmit:function(t,a){var n=a.setSubmitting;e.props.saveAction("Delete",t),n(!1)}},d.a.createElement(z.b,{mode:"themed"},d.a.createElement(z.c,{name:"id",label:"ID",disabled:!0}),d.a.createElement(z.c,{name:"code",label:"Code"}),d.a.createElement(z.c,{name:"title",label:"Title"}),d.a.createElement(z.f,{name:"description",label:"Description"}),d.a.createElement("div",{className:"w3-cell-row"},d.a.createElement("div",{className:"w3-cell"},d.a.createElement(z.a,{name:"startdate",label:"Start/End date"})),d.a.createElement("div",{className:"w3-cell"},d.a.createElement(z.a,{name:"enddate"}))),d.a.createElement(z.d,{name:"status",label:"Status",options:this.props.statusvalues}),d.a.createElement(z.c,{name:"value",type:"number",label:"Value",step:"0.01"}),d.a.createElement("hr",null),d.a.createElement(z.e,{className:"w3-button w3-light-grey w3-round",title:this.props.buttonText+"s this record",disabled:this.state.isSubmitting},d.a.createElement("i",{className:"fa fa-save"}),"\xa0",this.props.buttonText)))}}]),a}(d.a.Component),_=a(64),B=a(231),Y=a(118),G=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={isSubmitting:!1},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return d.a.createElement(V.b,{initialValues:this.props.currentData,enableReinitialize:!0,onSubmit:function(t,a){var n=a.setSubmitting;e.props.updateValues(Object(r.a)({},t)),n(!1)},validationSchema:U.object({description:U.string().required("Required"),plannedinvoicedate:U.date().required("Required"),actualinvoicedate:U.date(),amount:U.number().required("Required")})},d.a.createElement(z.b,{className:"w3-container",mode:"themed"},d.a.createElement(z.c,{name:"id",label:"ID",disabled:!0}),d.a.createElement(z.c,{name:"description",label:"Description"}),d.a.createElement("div",{className:"w3-cell-row"},d.a.createElement("div",{className:"w3-cell"},d.a.createElement(z.a,{name:"plannedinvoicedate",label:"Planned/Actual date",className:"w3-input w3-border"})),d.a.createElement("div",{className:"w3-cell"},d.a.createElement(z.a,{name:"actualinvoicedate",className:"w3-input w3-border"}))),d.a.createElement(z.c,{name:"amount",label:"Amount",type:"number",step:"0.01"}),d.a.createElement("hr",null),d.a.createElement(z.e,{className:"w3-button w3-light-grey w3-round",title:this.props.buttonText+"s this record",disabled:this.state.isSubmitting},d.a.createElement("i",{className:"fa fa-save"}),"\xa0",this.props.buttonText)))}}]),a}(d.a.Component),Q=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).openAddModal=function(){n.setState({modalAddIsOpen:!0,currentPaymentRecord:{id:-1,description:"",plannedinvoicedate:new Date,actualinvoicedate:new Date,amount:0,modifier:"Unchanged"}})},n.closeAddModalNoSave=function(){n.setState({modalAddIsOpen:!1,currentPaymentRecord:null})},n.openEditModal=function(e){n.props.currentData.paymentInfo&&n.setState({currentPaymentRecord:n.props.currentData.paymentInfo[e.row._index],modalEditIsOpen:!0,currentIndex:e.row._index})},n.closeEditModalNoSave=function(){n.setState({modalEditIsOpen:!1,currentPaymentRecord:null})},n.openDeleteModal=function(e){n.props.currentData.paymentInfo&&n.setState({currentPaymentRecord:n.props.currentData.paymentInfo[e.row._index],modalDeleteIsOpen:!0,currentIndex:e.row._index})},n.closeDeleteModalNoSave=function(){n.setState({modalDeleteIsOpen:!1,currentPaymentRecord:null})},n.updatePaymentLine=function(e){"Added"!==e.modifier&&(e.modifier="Modified"),n.props.updatePaymentline(e,!1,n.state.currentIndex),n.setState({modalEditIsOpen:!1,currentPaymentRecord:null})},n.addPaymentLine=function(e){e.modifier="Added",n.props.updatePaymentline(e,!0,n.state.currentIndex),n.setState({modalAddIsOpen:!1,currentPaymentRecord:null})},n.deletePaymentLine=function(e){e.modifier="Deleted",n.props.updatePaymentline(e,!1,n.state.currentIndex),n.setState({modalDeleteIsOpen:!1,currentPaymentRecord:null})},n.state={modalAddIsOpen:!1,modalEditIsOpen:!1,modalDeleteIsOpen:!1,currentPaymentRecord:null},n}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=[{Header:"Actions",Cell:function(t){return d.a.createElement("div",{className:"w3-bar"},d.a.createElement("button",{className:"w3-bar-item w3-button",title:"Edit",onClick:function(){e.openEditModal(t)}},d.a.createElement("i",{className:"fa fa-pencil"})),d.a.createElement("button",{className:"w3-bar-item w3-button",title:"Delete",onClick:function(){e.openDeleteModal(t)}},d.a.createElement("i",{className:"fa fa-trash-o"})),d.a.createElement("div",{className:"w3-dropdown-hover"},d.a.createElement("button",{className:"w3-button",title:"More actions..."},"..."),d.a.createElement("div",{className:"w3-dropdown-content w3-bar-block w3-card-4"},d.a.createElement("a",{href:"#",className:"w3-bar-item w3-button"},"Link 1"),d.a.createElement("a",{href:"#",className:"w3-bar-item w3-button"},"Link 2"),d.a.createElement("a",{href:"#",className:"w3-bar-item w3-button"},"Link 3"))))},sortable:!1},{Header:"ID",accessor:"id",show:!1},{Header:"Description",accessor:"description"},{id:"plannedinvoicedate",Header:"Planned date",accessor:function(e){return Y.a.formatDate(e.plannedinvoicedate)},sortMethod:Y.a.dateSorter},{id:"actualinvoicedate",Header:"Actual date",accessor:function(e){return Y.a.formatDate(e.actualinvoicedate)},sortMethod:Y.a.dateSorter},{id:"amount",Header:"Amount",accessor:function(e){return Y.a.formatAmount(e.amount)},style:{textAlign:"right"}}],a=this.props.currentData.paymentInfo;return d.a.createElement("div",null,d.a.createElement("button",{className:"w3-button w3-light-grey w3-round",onClick:this.openAddModal,title:"Add new record"},d.a.createElement("i",{className:"fa fa-plus-circle"}),"\xa0Add new"),this.props.currentData&&d.a.createElement(B.a,{className:"-striped",data:a,minRows:1,columns:t}),d.a.createElement(_.b,{isOpen:this.state.modalEditIsOpen},d.a.createElement(_.d,{toggle:this.closeEditModalNoSave,charCode:"\xd7"},"Edit Payment"),d.a.createElement(_.c,null,d.a.createElement(G,{buttonText:"Save",currentData:this.state.currentPaymentRecord,updateValues:this.updatePaymentLine}))),d.a.createElement(_.b,{isOpen:this.state.modalAddIsOpen},d.a.createElement(_.d,{toggle:this.closeAddModalNoSave,charCode:"\xd7"},"Add Payment"),d.a.createElement(_.c,null,d.a.createElement(G,{buttonText:"Add",currentData:this.state.currentPaymentRecord,updateValues:this.addPaymentLine}))),d.a.createElement(_.b,{isOpen:this.state.modalDeleteIsOpen},d.a.createElement(_.d,{toggle:this.closeDeleteModalNoSave,charCode:"\xd7"},"Delete Payment"),d.a.createElement(_.c,null,d.a.createElement(G,{buttonText:"Delete",currentData:this.state.currentPaymentRecord,updateValues:this.deletePaymentLine}))))}}]),a}(d.a.Component),W=a(167),X=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).saveOneRecord=function(e,t){var a="Added"===t.modifier?"POST":"Deleted"===t.modifier?"DELETE":"PUT",i={id:t.id,action:a,dataSubject:Object(r.a)({},t),subaction:e,additionalData:[]};W.a.saveRecord(i).then((function(e){e.success?(n.setState(Object(r.a)({},n.state,{currentData:e.dataSubject})),alert(e.message)):alert("Save failed "+e.message)})).catch((function(e){return alert(e)}))},n.updatePaymentline=function(e,t,a){if(t){var r,i=n.state.currentData;null===(r=i.paymentInfo)||void 0===r||r.push(e);n.setState({currentData:i})}else if(a&&n.state.currentData.paymentInfo){var o=n.state.currentData;o.paymentInfo&&("Deleted"===e.modifier&&-1===e.id?o.paymentInfo.splice(a,1):o.paymentInfo[a]=e,n.setState({currentData:o}))}alert("updatePaymentline "+(t?"Added":e.modifier)+" "+JSON.stringify(n.state.currentData,null,2))},n.props.match.params.id&&"add"!==n.props.match.params.id?n.state={id:parseInt(n.props.match.params.id,10),currentData:{id:0,code:"",description:"",title:"",startdate:new Date,enddate:new Date,status:"",value:0,paymentInfo:[],modifier:"Unchanged"},statusvalues:[]}:n.state={id:-1,currentData:{id:-1,code:"",description:"",title:"",startdate:new Date,enddate:new Date,status:"",value:0,paymentInfo:[],modifier:"Added"},statusvalues:[]},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;-1!==this.state.id&&W.a.loadOneRecord(this.state.id).then((function(t){console.log(t),e.setState({currentData:Object(r.a)({},t.dataSubject,{modifier:"Modified"})})})).catch((function(e){return console.error(e)})),W.a.loadDropdownValues("ContractStatus").then((function(t){e.setState({statusvalues:t.data})}))}},{key:"render",value:function(){return d.a.createElement(d.a.Fragment,null,d.a.createElement(u.b,{to:"/contract",className:"w3-button w3-light-grey w3-round",title:"Back to list"},d.a.createElement("i",{className:"fa fa-list"}),"\xa0Back to List")," ",d.a.createElement("hr",null),d.a.createElement(J,{defaultActiveKey:"details",id:"detailstab"},d.a.createElement(A,{eventKey:"details",title:"Details"},d.a.createElement(H,{buttonText:"Save",currentData:this.state.currentData,statusvalues:this.state.statusvalues,saveAction:this.saveOneRecord})),d.a.createElement(A,{eventKey:"payments",title:"Payments"},d.a.createElement(Q,{currentData:this.state.currentData,updatePaymentline:this.updatePaymentline}))))}}]),a}(d.a.Component);X.displayName=X.name;t.default=X}}]);
//# sourceMappingURL=5.7031ab64.chunk.js.map